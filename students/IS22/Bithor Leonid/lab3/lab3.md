# Лабораторная работа №3. Векторные базы данных и семантический поиск

## Цель

Целью работы было научиться использовать векторные базы данных и семантический поиск для обработки текстовых данных и потенциальной интеграции с LLM (Large Language Models).

## План

1. Настройка окружения;
2. Создание модуля для работы с Milvus;
3. Парсинг текстовых файлов;
4. Задания.

## Ход работы

Для успешного выполнения лабораторной работы, первым делом был скачан архив со всеми необходимыми файлами. После чего, было принято решение открыть данную рабочую область в devcontainer и для того, чтобы двигаться дальше, нужно понять, для чего он вообще нужен.

`Devcontainer` — это инструмент для создания предсказуемых и портативных сред разработки внутри Docker-контейнеров. Он решает проблему «работает на моей машине»,
автоматически настраивая единое окружение (софт, зависимости, инструменты) для всего проекта.
Как это работает и зачем нужно:
- Изоляция и воспроизводимость: Все зависимости (библиотеки, версии Python, системные пакеты) упакованы в контейнер.
- Это гарантирует, что приложение будет одинаково работать у всех в команде и на сервере.
- Быстрый старт: Новый разработчик может начать работу одной командой (Reopen in Container), не тратя часы на ручную настройку окружения.
- Единая среда: Инструменты форматирования, линтеры, расширения редактора кода можно предустановить, обеспечивая единый стандарт кода.
- Безопасность экспериментов: Можно тестировать новые версии зависимостей, не ломая основную систему.

В ходе лабораторной работы была исследована векторная база данных, предназначенная для хранения и обработки текстовой информации, а также использован интерфейс пользователя, подключенный к этой базе.

После запуска окружения, для продолжения выполнения заданий, потребовалось заполнить базу данных данными из подготовленных текстовых файлов. Это было реализовано с помощью запуска скрипта example_usage.py, который автоматически обрабатывает текстовые файлы: преобразует информацию в векторные представления, разделяет текст на фрагменты (чанки) и загружает их в базу данных.

## Задание №1. Запуск проекта при помощи GPU.

Рабочая область была подготовлена, после чего docker-compose файл настроили для поддержки GPU. Путём раскомментирования параметра gpus: all была добавлена возможность использовать ресурсы видеокарты через CUDA для генерации эмбеддингов.

![Рисунок 1](img/105128.png)

_Рисунок 1. Изменения конфигурации devcontainer.json_

![Рисунок 2](img/52.png)

_Рисунок 2. Успешно запущенный деф контейнер_

## Задание №2. Разработка API для взаимодействия с Milvus.
Реализовано API для работы с векторной базой данных Milvus с использованием Django Rest Framework для получения чанков, названия файла и текстового содержание файла, в котором содержится запрашиваемя часть текста.

Milvus — это специализированная база данных, созданная для работы с векторными данными (эмбеддингами), которые генерируют нейросетевые модели.
Главная задача и принцип работы:
- Решает проблему семантического поиска: Вместо поиска по точному совпадению слов (как в Google) Milvus ищет по смыслу. Например, по запросу «домашнее животное, которое ловит мышей» найдёт текст про кошек.
- Как это работает: Тексты, изображения или аудио с помощью моделей вроде sentence-transformers преобразуются в векторы — наборы чисел. Milvus хранит эти векторы и умеет молниеносно находить самые похожие (ближайшие соседи) по метрикам вроде косинусного расстояния.
- Ключевые преимущества: Высокая скорость поиска по миллиардам векторов, горизонтальная масштабируемость и удобная интеграция с современным ML-стеком (PyTorch, TensorFlow).

- Milvus имеет несколько главных структур, это:
- Collection (Коллекция). Аналог таблицы в реляционной БД. Это контейнер верхнего уровня для хранения векторов и связанных с ними данных;
- Partition (Раздел). Внутреннее разделение коллекции для оптимизации. Помогает организовать данные по логическим категориям для ускорения запросов (например, разделение по дате или категории товара);
- Field (Поле)
Отдельный элемент данных внутри коллекции. Бывает трёх основных типов:
  - Векторное поле (Vector Field): Хранит сами векторные эмбеддинги (например, поле embedding типа FloatVector);
  - Скалярное поле (Scalar Field): Хранит обычные метаданные — ID, текст, числа (например, book_title, year);
  - Первичный ключ (Primary Key): Специальное скалярное поле для уникальной идентификации каждой сущности (обычно целочисленное int64 или строковое VarChar).
- Entity (Сущность / Запись). Единая запись, соответствующая одному вектору и его связанным метаданным. Это полный набор значений всех полей схемы для одного объекта (например, один вектор + название одной книги + её год издания);
- Index (Индекс). Структура для ускорения поиска похожих векторов. Создаётся поверх векторного поля. Без индекса Milvus выполняет полный перебор (flat search), что медленно для больших объёмов;
- Segment (Сегмент). Базовая единица хранения и поиска внутри Milvus. Данные в коллекции автоматически разбиваются на сегменты для управления памятью и параллельной обработки;
- Alias (Псевдоним). Понятное имя для коллекции, которое можно динамически переназначать. Полезно для операций обновления без простоя: можно создать новую версию коллекции под тем же псевдонимом, и клиенты увидят её автоматически.

![Рисунок 3](img/104803.png)

_Рисунок 3. Загрузка модели и получение response кодов от сервера_

![Рисунок 4](img/104314.png)

_Рисунок 4. Выполнение POST запроса_

![Рисунок 5](img/104745.png)

_Рисунок 5. Выполнение POST запроса_

Attu - графический веб-интерфейс для визуального управления коллекциями Milvus;

![Рисунок 6](img/110007.png)

![Рисунок 7](img/110018.png)

_Рисунок 6 ,7: Универсальный инструмент администрирования Milvus - ATTU_


### Вывод

В процессе выполнения лабораторной работы удалось ознакомится с взаимодействем с векторной базой данных milvus. Так же был получен практический опыт настройки docker-контейнера на использованите мощностей видеокарты, путем конфигурации docker-compose файла. Через интерфейс Attu успешно проведён поиск по коллекциям, что подтвердило работоспособность системы. Для взаимодействия с системой частично реализован REST API (архитектурный стиль, который используется для взаимодействия между клиентом и сервером через протокол HTTP).
